# Обработка и генерация изображений

Репозиторий Китаева Сергея

## Задача 

### ДЗ 4. Обучение Stable diffusion 1.5 методом Dreambooth

Обучин Stable diffusion 1.5.
Параметры
--instance_prompt="a photo of sks woman face" токен на который мы хотим обучить персонажа

--class_prompt="a photo of woman face" промт для регуляризации

Чтобы не было language drift (когда модель уже содержит знания в каком-то из токенов) мы используем токен sks он был выбран авторами статьи как один и наименее частотных в датасете.

--instance_data_dir=$INSTANCE_DIR

--class_data_dir=$CLASS_DIR

Чтобы модель не забывала уже то, что знает и не переобучилась используется регуляризационный датасет (class images генерируется автоматически по промту class_prompt), чтобы изображения были более качественные можете самостоятельно собрать этот набор).


Ссылка на Kaggle-ноутбук: 
[https://www.kaggle.com/code/sergeykit/dcgan](https://www.kaggle.com/code/sergeykit/stylegan-hw)

#### Найдены проекции изображений в пространстве StyleGAN: 

 - с помощью среднего вектора латентного пространства (1)
     
 - с помощью лосса между выходами энкодера (2)


Исходные изображения | (1) | (2)

Оптимальные гиперпараметры:



#### Style transfer

Исходный стиль и его отображение в латентном пространстве:

Из вектора W+ брал последние индексы (интервал(9, 18), первые индексы сильно меняют атрибуты и форму лица



Трансфер стиля:


Исходный стиль и его отображение в латентном пространстве:



Трансфер стиля:



Исходный стиль и его отображение в латентном пространстве:



Трансфер стиля:



Если взять первые индексы:



### Expression Transfer

Улыбка - индексы - интервал от 0 до 5



Возраст - индексы - интервал от 0 до 9



Поворот головы - индексы -  от 0 до 6

